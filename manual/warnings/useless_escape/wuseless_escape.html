
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>[-Wuseless-escape] &#8212; re2c 0.16 documentation</title>
    <link rel="stylesheet" href="../../../_static/theme-re2c.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.16',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="alternate" type="application/atom+xml" href="../../../feed/atom.xml" title="Atom 1.0" />
    
 
  </head>
  <body>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="re2c-logo">
    re2c-0.16
</div>

<h3><a href="../../../index.html">Home</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../about/about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/install.html">Install</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../manual.html">Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../options/options.html">Options</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../warnings.html">Warnings</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../undefined_control_flow/wundefined_control_flow.html">[-Wundefined-control-flow]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../unreachable_rules/wunreachable_rules.html">[-Wunreachable-rules]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../condition_order/wcondition_order.html">[-Wcondition-order]</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">[-Wuseless-escape]</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#a-simple-example">A simple example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-it-works">How it works</a></li>
<li class="toctree-l4"><a class="reference internal" href="#real-world-examples">Real-world examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../swapped_range/wswapped_range.html">[-Wswapped-range]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../empty_character_class/wempty_character_class.html">[-Wempty-character-class]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../match_empty_string/wmatch_empty_string.html">[-Wmatch-empty-string]</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../syntax/syntax.html">Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../features/features.html">Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../news/news.html">News</a></li>
</ul>

    <h3>[-Wuseless-escape]</h3>
    <div class="re2c-toc-local">
        <ul>
<li><a class="reference internal" href="#">[-Wuseless-escape]</a><ul>
<li><a class="reference internal" href="#a-simple-example">A simple example</a></li>
<li><a class="reference internal" href="#how-it-works">How it works</a></li>
<li><a class="reference internal" href="#real-world-examples">Real-world examples</a></li>
</ul>
</li>
</ul>

    </div>

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="wuseless-escape">
<h1>[-Wuseless-escape]<a class="headerlink" href="#wuseless-escape" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="a-simple-example">
<h2>A simple example<a class="headerlink" href="#a-simple-example" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cpp"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/*!re2c</span>
<span class="cm">    *                        {}</span>
<span class="cm">    &quot;\a\A\&quot;\&#39;\[\]\-\x5d\377&quot; {}</span>
<span class="cm">    &#39;\a\A\&quot;\&#39;\[\]\-\x5d\377&#39; {}</span>
<span class="cm">    [\a\A\&quot;\&#39;\[\]\-\x5d\377] {}</span>
<span class="cm">*/</span>
</pre></div>
</td></tr></table></div>
<p>Given this code, <code class="docutils literal"><span class="pre">`re2c</span> <span class="pre">-Wuseless-escape`</span></code> reports a bunch of warnings:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>re2c: warning: line 3: column 11: escape has no effect: &#39;\A&#39; [-Wuseless-escape]
re2c: warning: line 3: column 15: escape has no effect: &#39;\&#39;&#39; [-Wuseless-escape]
re2c: warning: line 3: column 17: escape has no effect: &#39;\[&#39; [-Wuseless-escape]
re2c: warning: line 3: column 19: escape has no effect: &#39;\]&#39; [-Wuseless-escape]
re2c: warning: line 3: column 21: escape has no effect: &#39;\-&#39; [-Wuseless-escape]
re2c: warning: line 4: column 11: escape has no effect: &#39;\A&#39; [-Wuseless-escape]
re2c: warning: line 4: column 13: escape has no effect: &#39;\&quot;&#39; [-Wuseless-escape]
re2c: warning: line 4: column 17: escape has no effect: &#39;\[&#39; [-Wuseless-escape]
re2c: warning: line 4: column 19: escape has no effect: &#39;\]&#39; [-Wuseless-escape]
re2c: warning: line 4: column 21: escape has no effect: &#39;\-&#39; [-Wuseless-escape]
re2c: warning: line 5: column 11: escape has no effect: &#39;\A&#39; [-Wuseless-escape]
re2c: warning: line 5: column 13: escape has no effect: &#39;\&quot;&#39; [-Wuseless-escape]
re2c: warning: line 5: column 15: escape has no effect: &#39;\&#39;&#39; [-Wuseless-escape]
re2c: warning: line 5: column 17: escape has no effect: &#39;\[&#39; [-Wuseless-escape]
</pre></div>
</div>
<p>This is because the <code class="docutils literal"><span class="pre">\A</span></code> and <code class="docutils literal"><span class="pre">\[</span></code> escapes are meaningless in all rules,
<code class="docutils literal"><span class="pre">\-</span></code> makes sense only in a character class,
and each type of closing quotes (<code class="docutils literal"><span class="pre">&quot;</span></code>, <code class="docutils literal"><span class="pre">'</span></code> and <code class="docutils literal"><span class="pre">]</span></code>) should only be escaped inside of a string delimited with the same quotes.
Useless escapes are ignored: the escaped symbol is treated as not escaped (<code class="docutils literal"><span class="pre">\A</span></code> becomes <code class="docutils literal"><span class="pre">A</span></code>, etc.).
The above example should be fixed as follows:</p>
<div class="highlight-cpp"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/*!re2c</span>
<span class="cm">    *                    {}</span>
<span class="cm">    &quot;\aA\&quot;&#39;[]-\x5d\377&quot;  {}</span>
<span class="cm">    &#39;\aA&quot;\&#39;[]-\x5d\377&#39;  {}</span>
<span class="cm">    [\aA&quot;&#39;[\]\-\x5d\377] {}</span>
<span class="cm">*/</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="how-it-works">
<h2>How it works<a class="headerlink" href="#how-it-works" title="Permalink to this headline">¶</a></h2>
<p>re2c recognizes escapes in the following lexemes:</p>
<ul class="simple">
<li>double-quoted strings <code class="docutils literal"><span class="pre">&quot;</span> <span class="pre">...</span> <span class="pre">&quot;</span></code></li>
<li>single-quoted strings <code class="docutils literal"><span class="pre">'</span> <span class="pre">...</span> <span class="pre">'</span></code></li>
<li>character classes <code class="docutils literal"><span class="pre">[</span> <span class="pre">...</span> <span class="pre">]</span></code> and <code class="docutils literal"><span class="pre">[^</span> <span class="pre">...</span> <span class="pre">]</span></code></li>
</ul>
<p>The following escapes are recognized:</p>
<ul class="simple">
<li>Closing quotes (<code class="docutils literal"><span class="pre">\&quot;</span></code> for double-quoted strings, <code class="docutils literal"><span class="pre">\'</span></code> for single-quoted strings, and <code class="docutils literal"><span class="pre">\]</span></code> for character classes).</li>
<li>Dash <code class="docutils literal"><span class="pre">\-</span></code> in character classes.</li>
<li>Octal escapes: <code class="docutils literal"><span class="pre">\ooo</span></code>, where <code class="docutils literal"><span class="pre">o</span></code> is in range <code class="docutils literal"><span class="pre">[0</span> <span class="pre">-</span> <span class="pre">7]</span></code>
(the largest octal escape is <code class="docutils literal"><span class="pre">\377</span></code>, which equals <code class="docutils literal"><span class="pre">0xFF</span></code>).</li>
<li>Hexadecimal escapes: <code class="docutils literal"><span class="pre">\xhh</span></code>, <code class="docutils literal"><span class="pre">\Xhhhh</span></code>, <code class="docutils literal"><span class="pre">\uhhhh</span></code>, and <code class="docutils literal"><span class="pre">\Uhhhhhhhh</span></code>,
where <code class="docutils literal"><span class="pre">h</span></code> is in range <code class="docutils literal"><span class="pre">[0</span> <span class="pre">-</span> <span class="pre">9]</span></code>, <code class="docutils literal"><span class="pre">[a</span> <span class="pre">-</span> <span class="pre">f]</span></code>, or <code class="docutils literal"><span class="pre">[A</span> <span class="pre">-</span> <span class="pre">F]</span></code>.</li>
<li>Miscellaneous escapes: <code class="docutils literal"><span class="pre">\a</span></code>, <code class="docutils literal"><span class="pre">\b</span></code>, <code class="docutils literal"><span class="pre">\f</span></code>, <code class="docutils literal"><span class="pre">\n</span></code>, <code class="docutils literal"><span class="pre">\r</span></code>, <code class="docutils literal"><span class="pre">\t</span></code>, <code class="docutils literal"><span class="pre">\v</span></code>, <code class="docutils literal"><span class="pre">\\</span></code>.</li>
</ul>
<p>Ill-formed octal and hexadecimal escapes are treated as errors.
An escape followed by a newline is also an error: multiline strings and classes are not allowed
(this is very inconvenient; hopefully it will be fixed in the future).
Any other ill-formed escapes are ignored.
If <code class="docutils literal"><span class="pre">[-Wuseless-escape]</span></code> is enabled, re2c warns about ignored escapes.</p>
</div>
<div class="section" id="real-world-examples">
<h2>Real-world examples<a class="headerlink" href="#real-world-examples" title="Permalink to this headline">¶</a></h2>
<p>I found many useless escapes in real-world programs:</p>
<ul class="simple">
<li>A very strange escape <code class="docutils literal"><span class="pre">\*</span></code> in a regular expression such as <code class="docutils literal"><span class="pre">&quot;*\*&quot;</span></code>:
either someone wanted to write <code class="docutils literal"><span class="pre">&quot;*\\*&quot;</span></code> (with backslash in the middle),
or I have no explanation at all (considering that the first <code class="docutils literal"><span class="pre">*</span></code> is not escaped).
As far as I know, re2c has always treated <code class="docutils literal"><span class="pre">&quot;*\*&quot;</span></code> as <code class="docutils literal"><span class="pre">&quot;**&quot;</span></code>.</li>
<li><code class="docutils literal"><span class="pre">\h</span></code> in character classes (e.g., <code class="docutils literal"><span class="pre">[</span> <span class="pre">\h\t\v\f\r]</span></code>):
perhaps someone confused <code class="docutils literal"><span class="pre">\h</span></code> with a horizontal tab
(or even hostname <code class="docutils literal"><span class="pre">:)</span></code>).</li>
<li><code class="docutils literal"><span class="pre">\[</span></code> in character classes; this one is very common.</li>
<li><code class="docutils literal"><span class="pre">\/</span></code> in character classes (e.g. <code class="docutils literal"><span class="pre">[^\/\000]</span></code>) and strings (e.g., <code class="docutils literal"><span class="pre">&quot;\/*&quot;</span></code>).
However, there is one interesting case: <code class="docutils literal"><span class="pre">&quot;/****</span> <span class="pre">State</span> <span class="pre">&#64;&#64;</span> <span class="pre">***\/&quot;</span></code>:
here, the unescaped slash would end the multiline comment.
Perhaps <code class="docutils literal"><span class="pre">[-Wuseless-escape]</span></code> should be fixed to recognize such cases.</li>
<li><code class="docutils literal"><span class="pre">\.</span></code> in character classes (e.g., <code class="docutils literal"><span class="pre">[\.]</span></code>).</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
      Last updated on Aug 12, 2017.
    </div>
  </body>
</html>